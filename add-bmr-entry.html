<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SASV WORKSPACE | Add BMR Entry</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    /* === Header === */
    .header-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .header-bar h2 { margin:0; color:#005A8D }
    .action-link {
      font-size: 32px; cursor: pointer;
      transition: opacity .2s; user-select: none;
    }
    .action-link:hover { opacity: .7 }

    /* === CSV & Bulk Upload === */
    section { max-width:800px; margin:0 auto 30px }
    section h3 {
      margin-bottom:8px; color:#005A8D;
      display:flex; justify-content:space-between; align-items:center;
    }
    .link-button {
      background:none; border:none; color:var(--btn-bg);
      text-decoration:underline; cursor:pointer; font-size:14px;
    }
    .link-button:hover { opacity:.7 }

    /* === CSV preview table === */
    table.csv-preview {
      width:100%; border-collapse:collapse; margin-bottom:20px;
    }
    table.csv-preview th, td {
      border:1px dashed #999; padding:6px; background:#fafafa;
    }

    /* === Main input table === */
    table {
      width:100%; border-collapse:collapse; margin-bottom:20px;
    }
    th, td {
      padding:8px; border:1px solid #ccc; vertical-align:middle;
    }
    input[type="number"], select {
      width:100%; padding:6px; box-sizing:border-box;
      border:1px solid #ccc; border-radius:4px;
    }
    select.m-item { background:var(--input-bg); color:var(--input-text) }

    /* === Buttons & row controls === */
    .btn {
      background:var(--btn-bg); color:var(--btn-text);
      border:none; padding:8px 16px; border-radius:4px;
      cursor:pointer; font-size:14px; margin-right:8px;
    }
    .btn:hover { background:var(--btn-hover-bg) }
    .row-controls {
      display:flex; gap:4px; justify-content:center; align-items:center;
    }
    .row-add, .row-remove {
      background:none; border:none; cursor:pointer;
      font-size:18px; padding:0 4px; line-height:1;
    }
    .row-add { color:green } .row-remove { color:red }
    .row-add:hover, .row-remove:hover { opacity:.7 }

    /* === Preview overlay === */
    #previewOverlay {
      position:fixed; top:0; left:0; right:0; bottom:0;
      background:rgba(0,0,0,0.5); display:none;
      align-items:center; justify-content:center; z-index:1000;
    }
    #previewBox {
      background:var(--bg-color); color:var(--text-color);
      padding:20px; border-radius:8px;
      max-width:80%; max-height:80%; overflow:auto;
    }
    #previewTable {
      width:100%; border-collapse:collapse; margin-bottom:20px;
    }
    #previewTable th, td {
      border:1px solid #ccc; padding:8px;
    }
    .modal-actions { text-align:right; gap:10px }
    .modal-actions button { margin-left:8px }

    /* === Generic dialog overlay === */
    #dialogOverlay {
      position:fixed; top:0; left:0; right:0; bottom:0;
      background:rgba(0,0,0,0.5); display:none;
      align-items:center; justify-content:center; z-index:2000;
    }
    #dialogBox {
      background:var(--bg-color); color:var(--text-color);
      padding:20px; border-radius:8px;
      max-width:360px; text-align:center;
    }
    #dialogMessage { margin-bottom:20px }
    #dialogButtons button {
      margin:0 8px; padding:6px 14px; border:none;
      border-radius:4px; cursor:pointer;
      background:var(--btn-bg); color:var(--btn-text);
    }
    #dialogButtons button:hover { background:var(--btn-hover-bg) }
  </style>
</head>
<body data-theme="system">

  <!-- HEADER -->
  <div class="header-bar">
    <h2>Add BMR Entry</h2>
    <span id="homeIcon" class="action-link" title="Home">üè†</span>
  </div>

  <!-- CSV FORMAT PREVIEW -->
  <section>
    <h3>CSV Format Preview</h3>
    <table class="csv-preview">
      <thead>
        <tr><th>item</th><th>bn</th><th>batch_size</th><th>uom</th></tr>
      </thead>
      <tbody>
        <tr><td>ExampleItem</td><td>EX123</td><td>10</td><td>Kg</td></tr>
      </tbody>
    </table>
    <h3>
      Bulk Upload
      <button id="downloadTemplate" class="link-button">Download Template</button>
    </h3>
    <input type="file" id="csvFile" accept=".csv" />
    <button id="uploadCsv" class="btn">Upload CSV</button>
  </section>

  <!-- MULTIPLE ENTRY -->
  <section>
    <h3>Add BMR Entries</h3>
    <table id="multiTable">
      <thead>
        <tr>
          <th>Item</th><th>BN</th><th>Batch Size</th><th>UOM</th><th>‚Äâ</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><select class="m-item"></select></td>
          <td><input type="text"  class="m-bn"   /></td>
          <td><input type="number" class="m-size" step="0.01" min="0" /></td>
          <td>
            <select class="m-uom">
              <option value="">‚Äî UOM ‚Äî</option>
              <option>Kg</option><option>L</option><option>Nos</option><option>g</option><option>mL</option>
            </select>
          </td>
          <td>
            <div class="row-controls">
              <button class="row-add"    title="Add row">‚ûï</button>
              <button class="row-remove" title="Remove row">‚ûñ</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="controls">
      <button id="multiAdd"   class="btn">Add All</button>
      <button id="multiClear" class="btn">Clear</button>
    </div>
  </section>

  <!-- PREVIEW OVERLAY -->
  <div id="previewOverlay">
    <div id="previewBox">
      <h3>Confirm BMR Entries</h3>
      <table id="previewTable">
        <thead>
          <tr><th>#</th><th>Item</th><th>BN</th><th>Size</th><th>UOM</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="modal-actions">
        <button id="cancelPreview" class="btn">Edit</button>
        <button id="confirmPreview" class="btn">Confirm</button>
      </div>
    </div>
  </div>

  <!-- GENERIC DIALOG OVERLAY -->
  <div id="dialogOverlay">
    <div id="dialogBox">
      <div id="dialogMessage"></div>
      <div id="dialogButtons">
        <button id="btnYes">Yes</button>
        <button id="btnNo">No</button>
        <button id="btnOk">OK</button>
      </div>
    </div>
  </div>

  <script type="module" src="js/bmr-add.js"></script>
</body>
</html>